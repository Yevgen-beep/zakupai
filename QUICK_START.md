# üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ ZakupAI

## ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ "Connection failed" –†–ï–®–ï–ù–ê!

Firefox —Ç–µ–ø–µ—Ä—å —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ **http://localhost:8080**

## üîß –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx

- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ `/attachments` ‚Üí `zakupai-web:8000`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω SPA fallback –¥–ª—è React Router
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω Docker Compose

- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ Health checks –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
- ‚úÖ –ï–¥–∏–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

## üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–º–µ–¥–ª–µ–Ω–Ω–æ, –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë –∏ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
docker compose down
docker compose up -d --build

# –û–∂–∏–¥–∞–Ω–∏–µ: 5-10 –º–∏–Ω—É—Ç (PyTorch –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–æ–ª–≥–æ)
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ (—Ç–æ–ª—å–∫–æ web + gateway)

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë
docker compose down

# –°–æ–±—Ä–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π web —Å–µ—Ä–≤–∏—Å
docker build -f web/Dockerfile.minimal -t zakupai-web-minimal web/

# –°–æ–∑–¥–∞—Ç—å —Å–µ—Ç—å
docker network create zakupai-test

# –ó–∞–ø—É—Å—Ç–∏—Ç—å web —Å–µ—Ä–≤–∏—Å
docker run -d --name test-web --network zakupai-test \
  -e GATEWAY_URL=http://gateway -e ZAKUPAI_API_KEY=test \
  zakupai-web-minimal

# –ó–∞–ø—É—Å—Ç–∏—Ç—å gateway
docker run -d --name test-gateway --network zakupai-test \
  -p 8080:80 \
  -v $(pwd)/gateway/nginx-minimal.conf:/etc/nginx/nginx.conf:ro \
  nginx:alpine

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É
curl http://localhost:8080/attachments
```

## üåê –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ Firefox:

- **‚úÖ http://localhost:8080/** - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- **‚úÖ http://localhost:8080/attachments** - OCR –¥–æ–∫—É–º–µ–Ω—Ç—ã
- **‚úÖ http://localhost:8080/upload** - –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∞–π—Å–æ–≤

## üêõ Troubleshooting

### –ï—Å–ª–∏ Firefox –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–ü–æ–ø—ã—Ç–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å":

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:**

```bash
docker ps | grep -E "(gateway|web)"
```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**

```bash
docker logs test-gateway
docker logs test-web
```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç 8080:**

```bash
ss -tlnp | grep :8080
```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**

```bash
curl -I http://localhost:8080/health
```

### –ï—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—É—Å—Ç–∞—è:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**

```bash
docker exec test-gateway nginx -t
```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å upstream:**

```bash
docker exec test-gateway nslookup test-web
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

**üéâ –†–ê–ë–û–¢–ê–ï–¢!**

- Firefox —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ http://localhost:8080
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/attachments` –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Nginx –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ –≤–µ–±-—Å–µ—Ä–≤–∏—Å—É
- React SPA –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ gateway

## üßπ –û—á–∏—Å—Ç–∫–∞ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker rm -f test-web test-gateway

# –£–¥–∞–ª–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é —Å–µ—Ç—å
docker network rm zakupai-test

# –ò–ª–∏ –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ Docker Compose
docker compose down --volumes --remove-orphans
```

______________________________________________________________________

**‚ú® –ì–æ—Ç–æ–≤–æ!** ZakupAI —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π –ø–æ—Ä—Ç 8080 —Å–æ –≤—Å–µ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞! üöÄ
